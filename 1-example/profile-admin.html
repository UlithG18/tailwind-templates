<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Profile - Event Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen">

    <!-- Header -->
    <header class="bg-white shadow p-4 flex justify-between items-center">
        <h1 class="text-xl font-bold">Event Manager - Admin</h1>
        <a href="dashboard.html" class="text-indigo-500 hover:underline">
            Back to Dashboard
        </a>
    </header>

    <!-- Main content -->
    <main class="p-6 flex justify-center">
        <div class="bg-white rounded shadow p-6 w-full max-w-lg">

            <h2 class="text-2xl font-bold mb-6 text-center">
                Administrator Profile
            </h2>

            <!-- ========================= -->
            <!-- PROFILE IMAGE SECTION -->
            <!-- ========================= -->
            <div class="flex flex-col items-center mb-6">

                <!-- Profile image -->
                <img id="profileImage" src="" alt="Admin avatar"
                    class="w-24 h-24 rounded-full object-cover border mb-3" />

                <!-- File input -->
                <!-- JS will handle image selection -->
                <input type="file" id="imageInput" accept="image/*" class="text-sm" />
            </div>

            <!-- ========================= -->
            <!-- ADMIN INFORMATION -->
            <!-- ========================= -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

                <div>
                    <p class="text-sm text-gray-500">Full Name</p>
                    <p class="font-medium">Admin User</p>
                </div>

                <div>
                    <p class="text-sm text-gray-500">Email</p>
                    <p class="font-medium">admin@example.com</p>
                </div>

                <div>
                    <p class="text-sm text-gray-500">Role</p>
                    <p class="font-medium">Administrator</p>
                </div>

                <div>
                    <p class="text-sm text-gray-500">Account Status</p>
                    <p class="font-medium text-green-600">Active</p>
                </div>
            </div>

            <!-- ========================= -->
            <!-- ACTIONS -->
            <!-- ========================= -->
            <div class="mt-8 border-t pt-4">
                <h3 class="font-bold mb-3">
                    Administrative Actions
                </h3>

                <div class="flex flex-col sm:flex-row gap-3">
                    <a href="dashboard.html"
                        class="bg-indigo-500 text-white px-4 py-2 rounded text-center hover:bg-indigo-600">
                        Manage Events
                    </a>

                    <a href="#" class="bg-gray-500 text-white px-4 py-2 rounded text-center hover:bg-gray-600">
                        View Attendees
                    </a>
                </div>
            </div>

        </div>
    </main>

    <!-- ========================= -->
    <!-- JAVASCRIPT -->
    <!-- ========================= -->
    <script>
        // Simulated logged admin ID
        const currenSessionId = 1;
        const currenSessionRole = "admins";

        const imageInput = document.getElementById("imageInput");
        const profileImage = document.getElementById("profileImage");

        // Load avatar from json-server when page loads
        async function loadAdminAvatar() {
            const response = await fetch(`http://localhost:3000/${currenSessionRole}/${currenSessionId}`);
            const admin = await response.json();

            if (admin.avatar) {
                profileImage.src = admin.avatar;
            }
        }

        // Handle image selection
        imageInput.addEventListener("change", () => {
            const file = imageInput.files[0];
            if (!file) return;

            const reader = new FileReader();

            reader.onload = async () => {
                const img = reader.result;

                // Show preview immediately
                profileImage.src = img;

                // Save image in json-server
                await fetch(`http://localhost:3000/admins${currenSessionRole}/${currenSessionId}`, {
                    method: "PATCH",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        img
                    })
                });
            };

            reader.readAsDataURL(file);
        });

        // Initial load
        loadAdminAvatar();
    </script>

</body>

</html>